generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}


model User {
  full_name         String?
  username           String         @unique
  password          String
  role              UserRole   
  created_at        DateTime       @default(now())
  updated_at        DateTime       @updatedAt
  user_id           String         @id @default(uuid())
  attendance        Attendance[]
  group_members     GroupMembers[]
  gradedSubmissions Submissions[]  @relation("GraderSubmissions")
  submissions       Submissions[]  @relation("StudentSubmissions")
  studentPayments   StudentPayment[] @relation("StudentPayments")
  teacherSalaries   TeacherSalary[]  @relation("TeacherSalaries")
}

model Groups {
  group_id      String         @id @default(uuid())
  name          String         @unique
  description   String
  course        Course         @relation(fields: [course_id], references: [course_id])
  course_id     String
  status        GroupStatus    @default(ACTIVE)
  created_at    DateTime       @default(now())
  updated_at    DateTime       @updatedAt
  group_members GroupMembers[]
  lessons       Lessons[]
  schedules     Schedule[]
}

model GroupMembers {
  group_members_id String   @id @default(uuid())
  group_id         String
  user_id          String
  created_at       DateTime @default(now())
  updated_at       DateTime @updatedAt
  group            Groups   @relation(fields: [group_id], references: [group_id])
  user             User     @relation(fields: [user_id], references: [user_id])
}

model Lessons {
  lesson_id      String        @id @default(uuid())
  group_id       String
  topic          String
  lesson_date    DateTime
  recording_path String
  created_at     DateTime      @default(now())
  updated_at     DateTime      @updatedAt
  assignments    Assignments[]
  attendance     Attendance[]
  group          Groups        @relation(fields: [group_id], references: [group_id])
}

model Attendance {
  id         String   @id @default(uuid())
  groupId    String   @map("group_id")
  group      Group    @relation(fields: [groupId], references: [id])
  date       DateTime
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
}

model Assignments {
  id          String       @id @default(uuid())
  title       String
  description String
  due_date    DateTime
  groupId     String       @map("group_id")
  group       Group        @relation(fields: [groupId], references: [id])
  created_at  DateTime     @default(now())
  updated_at  DateTime     @updatedAt
}

model Submissions {
  submission_id String      @id @default(uuid())
  assignment_id String
  student_id    String
  graded_by     String
  file_path     String
  grade         String
  graded_at     DateTime
  feedback      String
  assignment    Assignments @relation(fields: [assignment_id], references: [assignment_id])
  graded        User        @relation("GraderSubmissions", fields: [graded_by], references: [user_id])
  student       User        @relation("StudentSubmissions", fields: [student_id], references: [user_id])
}

model Course {
  course_id    String   @id @default(uuid())
  name         String   @unique
  description  String
  duration     Int
  status       CourseStatus @default(ACTIVE)
  created_at    DateTime @default(now())
  updated_at    DateTime @updatedAt
  groups       Groups[]
}

model Schedule {
  schedule_id   String   @id @default(uuid())
  group_id      String
  day_of_week   Int
  start_time    DateTime
  end_time      DateTime
  room          String?
  created_at    DateTime @default(now())
  updated_at    DateTime @updatedAt
  group         Groups   @relation(fields: [group_id], references: [group_id])
}

model Student {
  id             String           @id @default(uuid())
  first_name     String
  last_name      String
  email          String           @unique
  password       String
  created_at     DateTime         @default(now())
  updated_at     DateTime         @updatedAt
  studentPayment StudentPayment[]
}

model StudentPayment {
  id         String        @id @default(uuid())
  amount     Float
  status     PaymentStatus @default(PENDING)
  type       PaymentType
  studentId  String
  student    Student       @relation(fields: [studentId], references: [id])
  created_at DateTime      @default(now())
  updated_at DateTime      @updatedAt
}

model Teacher {
  id            String          @id @default(uuid())
  first_name    String
  last_name     String
  email         String          @unique
  password      String
  created_at    DateTime        @default(now())
  updated_at    DateTime        @updatedAt
  teacherSalary TeacherSalary[]
}

model TeacherSalary {
  id         String        @id @default(uuid())
  amount     Float
  status     PaymentStatus @default(PENDING)
  teacherId  String
  teacher    Teacher       @relation(fields: [teacherId], references: [id])
  created_at DateTime      @default(now())
  updated_at DateTime      @updatedAt
}


enum PaymentStatus {
  PENDING
  COMPLETED
  CANCELLED
}

enum PaymentType {
  MONTHLY
  COURSE
  OTHER
}

enum UserRole {
  ADMIN
  MANAGER
  TEACHER
  STUDENT
}

enum CourseStatus {
  ACTIVE
  INACTIVE
  DRAFT
}

enum GroupStatus {
  ACTIVE
  INACTIVE
  COMPLETED
}

enum Gender {
  MALE
  FEMALE
}

enum AttendanceStatus {
  PRESENT
  ABSENT
  LATE
  EXCUSED
}